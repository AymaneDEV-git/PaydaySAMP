Dialog:Login(playerid, response, listitem, inputtext[])
{
	if (!response) return Kick(playerid);
	new hashed_pass[65];
	SHA256_PassHash(inputtext, Player[playerid][Salt], hashed_pass, 65);

	if (strcmp(hashed_pass, Player[playerid][Password]) == 0)
	{
		Dialog_Show(playerid, DIALOG_UNUSED, DIALOG_STYLE_MSGBOX, "Connexion", "Vous êtes à présent connecté.", "Continuer", "");

		KillTimer(Player[playerid][LoginTimer]);
		Player[playerid][LoginTimer] = 0;
		Player[playerid][IsLoggedIn] = true;
		SetPlayerColor(playerid, 0x00FFFFFF);

		//SetSpawnInfo(playerid, NO_TEAM, 0, Player[playerid][X_Pos], Player[playerid][Y_Pos], Player[playerid][Z_Pos], Player[playerid][A_Pos], 0, 0, 0, 0, 0, 0);
		//SpawnPlayer(playerid);
		return SearchForLobby(playerid);
	}
	else
	{
		Player[playerid][LoginAttempts]++;
		if (Player[playerid][LoginAttempts] >= 3)
		{
			Dialog_Show(playerid, DIALOG_UNUSED, DIALOG_STYLE_MSGBOX, "Connexion", "Vous avez tenté de trop nombreuses fois un mot de passe incorrect.\nVous avez été kick du serveur.", "Continuer", "");
			DelayedKick(playerid);
		}
		else Dialog_Show(playerid, Login, DIALOG_STYLE_PASSWORD, "Connexion", "Mot de passe incorrect !\nEntrez à nouveau votre mot de passe ci-dessous :", "Continuer", "Quitter");
	}
	return true;
}

Dialog:Register(playerid, response, listitem, inputtext[])
{
	if (!response) return Kick(playerid);
	if (strlen(inputtext) <= 5) return Dialog_Show(playerid, Register, DIALOG_STYLE_PASSWORD, "Inscription", "Votre mot de passe doit contenir plus de 5 caractères !\nEntrez à nouveau un mot de passe ci-dessous :", "Continuer", "Quitter");
	for (new i = 0; i < 16; i++) Player[playerid][Salt][i] = random(94) + 33;
	SHA256_PassHash(inputtext, Player[playerid][Salt], Player[playerid][Password], 65);
	orm_save(Player[playerid][ORM_ID], "OnPlayerRegister", "d", playerid);
	return true;
}